
<p>The reporting package generates visual reports, based upon usage statistics
which it tracks and records.

<p>The reporting mechanism gathers usage data by means of events. Events are
sent from various components of Eucalyptus (like the CLC and Walrus) to the
reporting system, either periodically or whenever some usage occurs.
The events are aggregated into reporting statistics which are stored in the
database.

<p>Usage statistics are aggregated and stored in the database as a series of
<i>snapshots</i>.  Each snapshot contains the total usage for a given
(user,account,cluster,avail_zone) tuple at a given moment in time. A series of
snapshots across some period (say 2010.01.01 to 2011.01.01) could be used to
extrapolate statistics of usage, which could then be used to generate a visual
report.

<p>The reporting system contains several <i>Reporting Modules</i>. At present,
three modules are implemented: Instance, Storage, and S3. Each module tracks
its own usage statistics, has its own event listener, and has its own database
tables. All reporting modules implement the "ReportingModule" interface, and
are organized as sub-packages under the "com.eucalyptus.reporting.modules"
package. Additional reporting modules could be added, by adding additional
sub-packages and implementing the ReportingModule interface.

<p>The reporting modules all have the following classes at present:
<ul>
 <li><i>UsageSnapshot</i> - a snapshot of resource usage at a moment of time,
     keyed by a (user,account,cluster,avail_zone,timestamp) tuple, and mapped
     to the DB using hibernate. A UsageSnapshot consists of a <i>SnapshotKey</i>
     object and a <i>UsageData</i> object.</li>
 <ul>
  <li><i>SnapshotKey</i> - A key for usage snapshots. Consists of (user,account,
     cluster,avail_zone,timestamp).</li>
  <li><i>UsageData</i> - Statistics of usage (like disk bandwidth used or S3
     objects used) at a single moment in time.</li>
 </ul>
 <li><i>UsageSummary</i> - Contains aggregated resource usage over an
     extended period of time. Aggregates several UsageSnapshots.</li>
 <li><i>ReportingModule</i> - An object which allows retrieval of statistics
     for some time period. This is the main class for accessing reporting
     statistics for each module. Contains logic for database queries,
     extrapolation, fractional periods, and so on. Contains a single primary
     method called <i>scanLog</i> for gathering usage information.</li>
 <li><i>ReportLine</i> - A bean which represents a single line in a visual
     report. It's like a UsageSummary, but with units adjusted for
     human-readable units (hours instead of milliseconds) and human-readable
     strings for criteria values</li>
</ul>

<p>Some of these classes in the various modules (UsageSnapshot, SnapshotKey,
UsageData, UsageSummary) are similarly named across modules but do not
implement common interfaces, because they are similar only in a very abstract
sense. They do not store the same statistics, or have the same method
signatures, or have the same object properties, or use the same keys, and so 
on. They follow a common general design, and so use similarly-named classes
(but with Instance-, Storage-, or S3- naming prefixes). In a future version,
some of this functionality will be factored out into a common package
which will use reflection to generate aggregate statistics for any kind of
bean classes with any properties.

<p>The current reporting modules all share a common structure and a similar way
of storing statistics as snapshots. However, this is only a <i>convention</i>
which has been followed for the existing reporting modules.  Any future
reporting module need not have similar classes or a similar organiztion;
it needs only to have its own module sub-package, and to implement
ReportingModule and ReportLine interfaces. It can store, aggregate, and
retrieve its statistics in any manner chosen by the developer.  It need not
necessarily store its statistics as a series of snapshots either.

<p>In addition to the reporting modules, the reporting system also has a
super-structure, which loads the modules, queries the modules for data,
listens for (and parses) web requests, maintains a queue of events,
generates visual reports using Jasper, caches frequently used reports, and so
on.

<p>The super-structure has a <i>queue</i> package for transmitting
events over the network if necessary, and a <i>units</i> package for unit
conversions.

<p>The entry point for the reporting system is the <i>ReportGenerator</i>
class, which acts as a facade for all the underlying logic and is the only
class accessed by outside facilities. It has a single method:
<i>generateReport</i>.

