<!--
  ~ Software License Agreement (BSD License)
  ~
  ~ Copyright (c) 2008, Regents of the University of California
  ~ All rights reserved.
  ~
  ~ Redistribution and use of this software in source and binary forms, with or
  ~ without modification, are permitted provided that the following conditions
  ~ are met:
  ~
  ~ * Redistributions of source code must retain the above
  ~   copyright notice, this list of conditions and the
  ~   following disclaimer.
  ~
  ~ * Redistributions in binary form must reproduce the above
  ~   copyright notice, this list of conditions and the
  ~   following disclaimer in the documentation and/or other
  ~   materials provided with the distribution.
  ~
  ~ THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  ~ AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  ~ IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
  ~ ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
  ~ LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
  ~ CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
  ~ SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
  ~ INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
  ~ CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
  ~ ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  ~ POSSIBILITY OF SUCH DAMAGE.
  ~
  ~ Author: Chris Grzegorczyk grze@cs.ucsb.edu
  -->

<wsp:Policy xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy">
  <wsp:ExactlyOne>
    <wsp:All>
      <sp:AsymmetricBinding xmlns:sp="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy">
	<wsp:Policy>
	  <sp:InitiatorToken>
	    <wsp:Policy>
	      <sp:X509Token sp:IncludeToken="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/AlwaysToRecipient">
		<wsp:Policy>
		  <sp:WssX509V3Token10/>
		</wsp:Policy>
	      </sp:X509Token>
	    </wsp:Policy>
	  </sp:InitiatorToken>
	  <sp:RecipientToken>
	    <wsp:Policy>
	      <sp:X509Token sp:IncludeToken="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/Never">
		<wsp:Policy>
		  <sp:WssX509V3Token10/>
		</wsp:Policy>
	      </sp:X509Token>
	    </wsp:Policy>
	  </sp:RecipientToken>
	  <sp:AlgorithmSuite>
	    <wsp:Policy>
	      <sp:Basic256Rsa15/>
	    </wsp:Policy>
	  </sp:AlgorithmSuite>
	  <sp:Layout>
	    <wsp:Policy>
	      <sp:Strict/>
	    </wsp:Policy>
	  </sp:Layout>

	  <sp:EncryptSignature/>
	  <sp:IncludeTimestamp/>
	  <!--<sp:OnlySignEntireHeadersAndBody/>-->

	</wsp:Policy>
      </sp:AsymmetricBinding>

      <sp:SignedSupportingTokens xmlns:sp="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy">
	<wsp:Policy>
	  <sp:UsernameToken sp:IncludeToken="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/Always"/>
	</wsp:Policy>
      </sp:SignedSupportingTokens>

      <sp:Wss10 xmlns:sp="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy">
	<wsp:Policy>
	  <!-- <sp:MustSupportRefKeyIdentifier/> -->
	  <sp:MustSupportRefEmbeddedToken/>
	  <!-- <sp:MustSupportRefIssuerSerial/> -->
	</wsp:Policy>
      </sp:Wss10>

      <sp:SignedParts xmlns:sp="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy">
	<sp:Header Namespace="http://www.w3.org/2005/08/addressing"/>
      </sp:SignedParts>

      <rampc:RampartConfig xmlns:rampc="http://ws.apache.org/rampart/c/policy">
	<rampc:User>eucalyptus</rampc:User>
        <rampc:PasswordType>Digest</rampc:PasswordType>
	<rampc:PasswordCallbackClass>/home/nurmi/eucalyptus/danroot//var/eucalyptus/keys/libpwcb.so</rampc:PasswordCallbackClass>
	<rampc:ReceiverCertificate>/home/nurmi/eucalyptus/danroot//var/eucalyptus/keys/cluster-cert.pem</rampc:ReceiverCertificate>
	<rampc:Certificate>/home/nurmi/eucalyptus/danroot//var/eucalyptus/keys/cloud-cert.pem</rampc:Certificate>
	<rampc:PrivateKey>/home/nurmi/eucalyptus/danroot//var/eucalyptus/keys/cloud-pk.pem</rampc:PrivateKey>
      </rampc:RampartConfig>
    </wsp:All>
  </wsp:ExactlyOne>
</wsp:Policy>
